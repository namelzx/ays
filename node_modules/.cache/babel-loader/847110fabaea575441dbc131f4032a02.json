{"remainingRequest":"/Users/liangzexiang/WebstormProjects/ays/node_modules/thread-loader/dist/cjs.js!/Users/liangzexiang/WebstormProjects/ays/node_modules/babel-loader/lib/index.js!/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzexiang/WebstormProjects/ays/src/views/shop/manage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzexiang/WebstormProjects/ays/src/views/shop/manage.vue","mtime":1587402564000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { Citylist } from \"@/api/city\";\nimport { GetSaleByAll } from \"@/api/salesman\";\nimport { GetDataByList, GetDataBydownload } from \"@/api/shop\";\nimport waves from \"@/directive/waves\";\nimport { getArrByKey, pickerOptions } from \"@/utils\";\nimport { regionDataPlus } from \"element-china-area-data\";\nvar defaultForm = {\n  openid: \"oQJN40ldFZYLvqoIZm3NGwFu8oKA\",\n  lazada_id: \"\",\n  lazada_list: \"\",\n  lazada_index: \"\",\n  buy_order_no: \"12123\",\n  buy_account: \"199\",\n  buy_product_id: \"\",\n  no_price: \"199\",\n  contact: \"梁泽祥\",\n  tel: \"18677947067\",\n  city_code: undefined,\n  city_desc: \"\",\n  number_plate: \"A871237\",\n  car_model: undefined,\n  car_index: \"\",\n  car_model_id: \"\"\n};\nexport default {\n  name: \"Roles\",\n  // components: { rolesForm },\n  directives: {\n    waves: waves\n  },\n  components: {},\n  filters: {\n    statusFilter: function statusFilter(status) {\n      var statusMap = {\n        0: \"禁用\",\n        1: \"正常\"\n      };\n      return statusMap[status];\n    }\n  },\n  data: function data() {\n    return {\n      loading: true,\n      sumorder: 0,\n      productTree: [],\n      //产品树\n      reTitle: \"\",\n      reFrom: {\n        role: 2,\n        type: 1\n      },\n      op: [{\n        value: 1,\n        label: \"普通\"\n      }, {\n        value: 2,\n        label: \"阿帕认证\"\n      }, {\n        value: 3,\n        label: \"阿帕三星\"\n      }, {\n        value: 4,\n        label: \"阿帕四星\"\n      }, {\n        value: 5,\n        label: \"阿帕五星\"\n      }],\n      list: null,\n      total: null,\n      postFrom: Object.assign({}, defaultForm),\n      cityoptions: [],\n      //地址\n      selectedRows: null,\n      listLoading: true,\n      showSearch: false,\n      optionsrec: [{\n        value: 1,\n        label: \"电商推荐\"\n      }],\n      optionsmk: [{\n        value: 1,\n        label: \"市场推荐\"\n      }],\n      options: [],\n      shop: [],\n      listQuery: {\n        page: 1,\n        limit: 10,\n        // status: 'all',\n        title: \"\"\n      },\n      salesman: [],\n      //业务员\n      buttonDisabled: true,\n      deleting: false,\n      pickerOptions: pickerOptions,\n      currentIndex: -1,\n      regionHiera: [],\n      Stitle: \"\"\n    };\n  },\n  computed: {},\n  watch: {},\n  created: function created() {\n    var _this2 = this;\n\n    this.fetchList();\n    GetSaleByAll().then(function (res) {\n      _this2.salesman = res.data;\n    });\n    Citylist().then(function (res) {\n      _this2.cityoptions = res.data;\n    });\n  },\n  methods: {\n    elCascaderOnlick: function elCascaderOnlick() {\n      var that = this;\n      setTimeout(function () {\n        document.querySelectorAll(\".el-cascader-node__label\").forEach(function (el) {\n          el.onclick = function () {\n            this.previousElementSibling.click();\n            that.$refs.elcascader.dropDownVisible = false;\n          };\n        });\n        document.querySelectorAll(\".el-cascader-panel .el-radio\").forEach(function (el) {\n          el.onclick = function () {\n            that.$refs.elcascader.dropDownVisible = false;\n          };\n        });\n      }, 100);\n    },\n    //所选门店\n    fetchList: function fetchList() {\n      var _this3 = this;\n\n      this.listLoading = true;\n      GetDataByList(this.listQuery).then(function (response) {\n        _this3.list = response.data.data;\n        _this3.total = response.data.total;\n        _this3.listLoading = !_this3.listLoading;\n      });\n    },\n    handleFilter: function handleFilter() {\n      this.listQuery.page = 1;\n      this.fetchList();\n    },\n    handleFilterClear: function handleFilterClear() {\n      this.listQuery = {\n        page: 1,\n        psize: 10,\n        status: \"-1\",\n        title: \"\"\n      };\n      this.fetchList();\n    },\n    handleSizeChange: function handleSizeChange(val) {\n      this.listQuery.psize = val;\n      this.fetchList();\n    },\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.listQuery.page = val;\n      this.fetchList();\n    },\n    handleModifyStatus: function handleModifyStatus(index, id, status) {\n      this.list[index][\"status\"] = 1 - status;\n      change(id, \"status\", 1 - status).then(function (response) {});\n    },\n    handleSelectionChange: function handleSelectionChange(val) {\n      if (val.length > 0) {\n        this.buttonDisabled = false;\n      } else {\n        this.buttonDisabled = true;\n      }\n\n      this.selectedRows = val;\n    },\n    handleCreate: function handleCreate() {\n      this.$refs.fromRoles.handleCreate();\n    },\n    handleUpdate: function handleUpdate(row) {\n      this.postFrom = {};\n      this.postFrom = row;\n\n      if (row.city_code.constructor === String) {\n        this.postFrom.city_code = this.postFrom.city_code.split(\",\");\n      }\n\n      if (row.car_model !== null) {\n        if (row.car_model.constructor === String) {\n          this.postFrom.car_model = this.postFrom.car_model.split(\",\");\n        }\n      }\n\n      if (row.buy_product_id !== null) {\n        if (row.buy_product_id.constructor === String) {\n          var arr = [];\n          var temp = this.postFrom.buy_product_id.split(\",\");\n\n          for (var i = 0; i < temp.length; i++) {\n            arr.push(parseInt(temp[i]));\n          }\n\n          this.postFrom.buy_product_id = arr;\n        }\n      }\n\n      if (row.lazada_list !== null) {\n        if (row.lazada_list.constructor === String) {\n          this.postFrom.lazada_list = this.postFrom.lazada_list.split(\",\");\n        }\n\n        var lazada = this.postFrom.lazada_list;\n        this.postFrom.lazada_list = [];\n\n        for (var _i = 0; _i < lazada.length; _i++) {\n          this.postFrom.lazada_list.push(parseInt(lazada[_i]));\n        }\n      }\n\n      this.is_disabled = false;\n\n      if (this.postFrom.status === \"驳回\") {\n        this.postFrom.status = \"重新派单\";\n      }\n\n      console.log(this.userinfo);\n      this.Stitle = this.userinfo.realName + \"-\" + this.userinfo.group.title + this.postFrom.status + \"操作\";\n      this.dialogVisible = !this.dialogVisible;\n    },\n    handleClose: function handleClose() {\n      this.dialogVisible = !this.dialogVisible;\n      this.fetchList();\n    },\n    handleDelete: function handleDelete(index, id) {\n      var _this4 = this;\n\n      var _this = this;\n\n      this.$confirm(\"此操作将永久删除该记录, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"warning\"\n      }).then(function () {\n        _this.$set(_this.list[index], \"delete\", true);\n\n        del(id).then(function (response) {\n          if (response.status === 1) {\n            _this.list.splice(index, 1);\n\n            _this.total = _this.total - 1;\n\n            _this.$notify.success(response.msg);\n\n            _this4.fetchList();\n          } else {\n            _this.$notify.error(response.msg);\n          }\n\n          _this.$set(_this.list[index], \"delete\", false);\n        }).catch(function (error) {\n          _this.$set(_this.list[index], \"delete\", false);\n        });\n      }).catch(function () {\n        _this4.$message({\n          type: \"info\",\n          message: \"已取消删除\"\n        });\n      });\n    },\n    handleDeleteAll: function handleDeleteAll() {\n      var _this5 = this;\n\n      var _this = this;\n\n      if (this.selectedRows.length > 0) {\n        this.$confirm(\"此操作将永久删除该记录, 是否继续?\", \"提示\", {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\"\n        }).then(function () {\n          _this.deleting = true;\n          var ids = getArrByKey(_this.selectedRows, \"id\");\n          var idstr = ids.join(\",\");\n          delAll({\n            ids: idstr\n          }).then(function (response) {\n            if (response.status === 1) {\n              var delindex = [];\n\n              _this.list.forEach(function (item, index, input) {\n                if (ids.indexOf(item.id) > -1) {\n                  delindex.push(index);\n                }\n              });\n\n              for (var i = delindex.length - 1; i >= 0; i--) {\n                _this.list.splice(delindex[i], 1);\n              }\n\n              _this.total = _this.total - delindex.length;\n\n              _this.$message.success(response.msg);\n            } else {\n              _this.$message.error(response.msg);\n            }\n\n            _this.deleting = false;\n          }).catch(function (error) {\n            _this.deleting = false;\n          });\n        }).catch(function () {\n          _this5.$message({\n            type: \"info\",\n            message: \"已取消删除\"\n          });\n        });\n      } else {\n        _this.$message.error(\"请选择要删除的数据\");\n      }\n    },\n    //导出数据\n    handleDownload: function handleDownload() {\n      var _this6 = this;\n\n      this.listLoading = true;\n      GetDataBydownload(this.listQuery).then(function (res) {\n        import('@/vendor/Export2Excel').then(function (excel) {\n          console.log(excel);\n          var tHeader = res.data.tHeader;\n          var filterVal = res.data.filterVal;\n\n          var data = _this6.formatJson(res.data.data, filterVal);\n\n          var day2 = new Date();\n          day2.setTime(day2.getTime());\n          var s2 = day2.getFullYear() + '-' + (day2.getMonth() + 1) + '-' + day2.getDate();\n          excel.export_json_to_excel({\n            header: tHeader,\n            data: data,\n            filename: s2\n          });\n          _this6.listLoading = false;\n\n          _this6.$message.success('下载成功');\n        });\n      });\n    },\n    formatJson: function formatJson(data, filterVal) {\n      return data.map(function (v) {\n        return filterVal.map(function (j) {\n          if (j === 'timestamp') {\n            return parseTime(v[j]);\n          } else {\n            return v[j];\n          }\n        });\n      });\n    },\n    handleCommand: function handleCommand(command) {\n      var _this = this;\n\n      if (this.selectedRows.length > 0) {\n        var ids = getArrByKey(this.selectedRows, \"id\");\n        var idstr = ids.join(\",\");\n        changeAll({\n          val: idstr,\n          field: \"status\",\n          value: command\n        }).then(function (response) {\n          if (response.status === 1) {\n            _this.list.forEach(function (item, index, input) {\n              if (ids.indexOf(item.id) > -1) {\n                _this.list[index][\"status\"] = command;\n              }\n            });\n\n            _this.$message.success(response.msg);\n          } else {\n            _this.$message.error(response.msg);\n          }\n        }).catch(function (error) {});\n      } else {\n        _this.$message.error(\"请选择要操作的数据\");\n      }\n    }\n  }\n};",null]}