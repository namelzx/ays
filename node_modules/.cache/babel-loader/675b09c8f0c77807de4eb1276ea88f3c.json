{"remainingRequest":"/Users/liangzexiang/WebstormProjects/ays/node_modules/thread-loader/dist/cjs.js!/Users/liangzexiang/WebstormProjects/ays/node_modules/babel-loader/lib/index.js!/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzexiang/WebstormProjects/ays/src/views/order/install/create.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzexiang/WebstormProjects/ays/src/views/order/install/create.vue","mtime":1587402564000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.split\";\nimport _objectSpread from \"/Users/liangzexiang/WebstormProjects/ays/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread2\";\nimport _defineProperty from \"/Users/liangzexiang/WebstormProjects/ays/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters } from \"vuex\";\nimport { GetProductByTree } from \"@/api/product\";\nimport { validURL } from \"@/utils/validate\";\nimport { fetchArticle } from \"@/api/article\";\nimport { GetProductByAll, GetDataProductByList } from \"@/api/product\";\nimport { CarBrand } from \"@/api/tools\";\nimport { GetDataByList } from \"@/api/ecshop\";\nimport { PostDataByAdd } from \"@/api/order\";\nimport { GetBrandByList, GetModelByList, GetSeriesByList } from \"@/api/car\";\nimport { regionDataPlus } from \"element-china-area-data\";\nimport { searchUser } from \"@/api/remote-search\";\n\nvar defaultForm = _defineProperty({\n  openid: \"\",\n  lazada_id: \"\",\n  lazada_list: \"\",\n  lazada_index: \"\",\n  buy_order_no: \"\",\n  buy_account: \"\",\n  buy_product_id: \"\",\n  no_price: \"\",\n  contact: \"\",\n  tel: \"\",\n  city_code: [],\n  city_desc: \"\",\n  number_plate: \"\",\n  car_model: \"\",\n  car_index: \"\",\n  car_model_id: \"\"\n}, \"car_model_id\", \"\");\n\nexport default {\n  name: \"ArticleDetail\",\n  // props: {\n  //   isEdit: {\n  //     type: Boolean,\n  //     default: false\n  //   }\n  // },\n  data: function data() {\n    var _this = this;\n\n    var validateRequire = function validateRequire(rule, value, callback) {\n      if (value === \"\") {\n        _this.$message({\n          message: rule.field + \"为必传项\",\n          type: \"error\"\n        });\n\n        callback(new Error(rule.field + \"为必传项\"));\n      } else {\n        callback();\n      }\n    };\n\n    var validateSourceUri = function validateSourceUri(rule, value, callback) {\n      if (value) {\n        if (validURL(value)) {\n          callback();\n        } else {\n          _this.$message({\n            message: \"外链url填写不正确\",\n            type: \"error\"\n          });\n\n          callback(new Error(\"外链url填写不正确\"));\n        }\n      } else {\n        callback();\n      }\n    };\n\n    return {\n      brandid: \"\",\n      //品牌id\n      series_id: \"\",\n      //车系id\n      model_id: undefined,\n      //车型id\n      ecshop: [],\n      //平台商家\n      productTree: [],\n      //产品树\n      cityoptions: regionDataPlus,\n      cityselectedOptions: [],\n      postForm: Object.assign({}, defaultForm),\n      loading: false,\n      userListOptions: [],\n      vmindex: \"\",\n      rules: {\n        image_uri: [{\n          validator: validateRequire\n        }],\n        title: [{\n          validator: validateRequire\n        }],\n        content: [{\n          validator: validateRequire\n        }],\n        source_uri: [{\n          validator: validateSourceUri,\n          trigger: \"blur\"\n        }]\n      },\n      tempRoute: {},\n      product: [],\n      selectedRegion: [],\n      //选中的车型下标\n      selectedShop: [],\n      //选中的平台下标\n      regionHiera: [],\n      listechsop: {\n        pid: undefined\n      }\n    };\n  },\n  computed: _objectSpread({}, mapGetters([\"carList\", \"userinfo\"]), {\n    contentShortLength: function contentShortLength() {\n      return this.postForm.content_short.length;\n    },\n    displayTime: {\n      // set and get is useful when the data\n      // returned by the back end api is different from the front end\n      // back end return => \"2013-06-25 06:59:25\"\n      // front end need timestamp => 1372114765000\n      get: function get() {\n        return +new Date(this.postForm.display_time);\n      },\n      set: function set(val) {\n        this.postForm.display_time = new Date(val);\n      }\n    }\n  }),\n  created: function created() {\n    var _this2 = this;\n\n    CarBrand().then(function (res) {\n      _this2.regionHiera = res.data;\n    });\n    GetProductByTree().then(function (res) {\n      _this2.productTree = res.data;\n    });\n    this.getecshop();\n    this.getProduct();\n    this.tempRoute = Object.assign({}, this.$route);\n  },\n  methods: {\n    getProduct: function getProduct() {\n      var _this3 = this;\n\n      var pid = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var temp = {\n        pid: pid\n      };\n      GetProductByAll(temp).then(function (res) {\n        _this3.product = res.data;\n      });\n\n      if (this.isEdit) {\n        var id = this.$route.params && this.$route.params.id;\n        this.fetchData(id);\n      }\n    },\n    getecshop: function getecshop() {\n      var _this4 = this;\n\n      var type = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n      var val = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      GetDataByList(this.listechsop).then(function (res) {\n        if (type === 0) {\n          var arr = [];\n\n          for (var i = 0; i < res.data.length; i++) {\n            arr.push({\n              label: res.data[i].field_title,\n              id: res.data[i].id,\n              value: i,\n              children: []\n            });\n          }\n\n          _this4.ecshop = arr;\n        }\n\n        if (type === 1) {\n          var _arr = [];\n\n          for (var _i = 0; _i < res.data.length; _i++) {\n            _arr.push({\n              label: res.data[_i].field_title,\n              id: res.data[_i].id,\n              value: _i\n            });\n          }\n\n          if (res.data.length === 0) {\n            _this4.ecshop[val[0]].children = undefined;\n          } else {\n            _this4.ecshop[val[0]].children = _arr;\n          }\n        }\n      });\n    },\n    handelNodes: function handelNodes(e) {\n      console.log(e);\n    },\n    handleEcshopChange: function handleEcshopChange(val) {\n      this.listechsop.pid = this.ecshop[val[0]].id;\n      this.getecshop(1, val);\n      this.selectedShop = val;\n    },\n    fetchData: function fetchData(id) {\n      var _this5 = this;\n\n      fetchArticle(id).then(function (response) {\n        _this5.postForm = response.data; // just for test\n\n        _this5.postForm.title += \"   Article Id:\".concat(_this5.postForm.id);\n        _this5.postForm.content_short += \"   Article Id:\".concat(_this5.postForm.id); // set tagsview title\n\n        _this5.setTagsViewTitle(); // set page title\n\n\n        _this5.setPageTitle();\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    setTagsViewTitle: function setTagsViewTitle() {\n      var title = \"Edit Article\";\n      var route = Object.assign({}, this.tempRoute, {\n        title: \"\".concat(title, \"-\").concat(this.postForm.id)\n      });\n      this.$store.dispatch(\"tagsView/updateVisitedView\", route);\n    },\n    setPageTitle: function setPageTitle() {\n      var title = \"Edit Article\";\n      document.title = \"\".concat(title, \" - \").concat(this.postForm.id);\n    },\n    submitForm: function submitForm() {\n      var _this6 = this;\n\n      if (this.selectedShop.length < 1) {\n        this.$message.error(\"购买平台必选\");\n        return;\n      }\n\n      this.postForm.car_model_id = this.selectedRegion[this.selectedRegion.length - 1];\n      this.postForm.lazada_index = this.selectedShop.join(\",\"); //下标 最多两个\n      //处理购买平台数据\n      // this.postForm.lazada_list = ''\n\n      this.postForm.lazada_list = this.ecshop[this.selectedShop[0]].id;\n      this.postForm.lazada_id = this.ecshop[this.selectedShop[0]].id;\n      this.postForm.lazada_index = this.selectedShop.join(\",\");\n\n      if (this.ecshop[this.selectedShop[0]].children !== undefined) {\n        this.postForm.lazada_list = this.postForm.lazada_list + \",\" + this.ecshop[this.selectedShop[0]].children[this.selectedShop[1]].id;\n        this.postForm.lazada_id = this.ecshop[this.selectedShop[0]].children[this.selectedShop[1]].id;\n      }\n\n      this.postForm.car_model = this.postForm.car_model.join(\",\");\n      this.postForm.city_code = this.postForm.city_code.join(\",\"); //\n\n      this.postForm.buy_product_id = this.postForm.buy_product_id.join(\",\");\n      this.postForm.logcontent = \"待处理\" + \" \" + this.userinfo.realName + \"提交订单\";\n      PostDataByAdd(this.postForm).then(function (res) {\n        _this6.postForm.car_model = _this6.postForm.car_model.split(\",\");\n\n        _this6.$router.go(-1); //返回上一层\n\n\n        _this6.$message.success(\"操作成功\");\n      });\n    },\n    draftForm: function draftForm() {\n      if (this.postForm.content.length === 0 || this.postForm.title.length === 0) {\n        this.$message({\n          message: \"请填写必要的标题和内容\",\n          type: \"warning\"\n        });\n        return;\n      }\n\n      this.$message({\n        message: \"保存成功\",\n        type: \"success\",\n        showClose: true,\n        duration: 1000\n      });\n      this.postForm.status = \"draft\";\n    },\n    getRemoteUserList: function getRemoteUserList(query) {\n      var _this7 = this;\n\n      searchUser(query).then(function (response) {\n        if (!response.data.items) return;\n        _this7.userListOptions = response.data.items.map(function (v) {\n          return v.name;\n        });\n      });\n    }\n  }\n};",null]}