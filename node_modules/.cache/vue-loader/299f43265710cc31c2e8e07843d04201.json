{"remainingRequest":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzexiang/WebstormProjects/ays/src/views/cost/install/sendOrder.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzexiang/WebstormProjects/ays/src/views/cost/install/sendOrder.vue","mtime":1587637488397},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {CarBrand} from \"@/api/tools\";\nimport ShList from \"@/components/shop/index\";\n\nimport {Citylist} from \"@/api/city\";\n\nimport {GetSaleByAll} from \"@/api/salesman\";\nimport {mapGetters} from \"vuex\";\n\nimport {GetDataByList, GetDataByShopAll} from \"@/api/shop\";\n\nimport {\n    change,\n    changeAll,\n    del,\n    delAll,\n    GetIdBydetails,\n    PostDataByAdd\n} from \"@/api/payorder\";\nimport {GetecshopByList} from \"@/api/ecshop\";\nimport {getArrByKey, pickerOptions} from \"@/utils\";\nimport {GetProductByTree} from \"@/api/product\";\n\nimport UploadList from \"@/components/Upload/uploadList\";\n\nconst defaultForm = {\n    logcontent: \"\",\n    openid: \"\",\n    lazada_id: \"\",\n    lazada_list: \"\",\n    lazada_index: \"\",\n    buy_order_no: \"12123\",\n    buy_account: \"199\",\n    buy_product_id: \"\",\n    no_price: \"199\",\n    contact: \"\",\n    tel: \"\",\n    city_code: undefined,\n    city_desc: \"\",\n    number_plate: \"A871237\",\n    car_model: undefined,\n    car_index: \"\",\n    car_model_id: \"\"\n};\n\nexport default {\n    name: \"SendOrder\",\n    data() {\n        return {\n            is_load: false,\n            shopQuery: {\n                cityCode: undefined,\n                shopname: undefined,\n                page: 1,\n                limit: 10,\n                tel: undefined\n            },\n            imglist: [],\n            videolist: [],\n            is_disabled: false,\n            loading: false,\n            innerVisible: false,\n            // dialogVisible: false,\n            checked: true,\n            tableKey: 0,\n            CarModellist: [], // 车型数据\n            lazada: [], // 所有平台\n            salesman: [], // 所有业务员\n            retype: [\n                {\n                    label: \"售后退款\",\n                    value: \"售后退款\"\n                },\n                {\n                    label: \"返现奖励\",\n                    value: \"返现奖励\"\n                },\n                {\n                    label: \"支架\",\n                    value: \"支架\"\n                },\n                {\n                    label: \"其他\",\n                    value: \"其他\"\n                }\n            ], //\n\n            carl: [],\n            list: null,\n            total: null,\n\n            // postFrom: Object.assign({}, defaultForm),\n            cityoptions: [], // 地址\n            selectedRows: null,\n            listLoading: true,\n            showSearch: false,\n            options: [],\n            shop: [],\n            shoptotal: 0,\n            listQuery: {\n                page: 1,\n                limit: 10,\n                status: \"-1\",\n                title: \"\"\n            },\n            postFrom: {},\n            buttonDisabled: true,\n            deleting: false,\n            pickerOptions: pickerOptions,\n            currentIndex: -1,\n            productTree: [],\n            regionHiera: [],\n            shop: [],\n            shoplist: [],\n            innerVisible: false\n        };\n    },\n    computed: {\n        ...mapGetters([\"userinfo\", \"brand\"])\n    },\n    components: {\n        UploadList,\n        ShList\n    },\n    props: {\n        Stitle: String,\n        dialogVisible: {\n            type: Boolean,\n            default: false\n        }\n    },\n    created() {\n        Citylist().then(res => {\n            this.cityoptions = res.data;\n        });\n        this.getshopList();\n\n        if (this.brand === undefined) {\n            CarBrand().then(res => {\n                this.regionHiera = res.data;\n            });\n        } else {\n            this.regionHiera = this.brand;\n        }\n        GetProductByTree().then(res => {\n            this.productTree = res.data;\n        });\n        GetecshopByList().then(res => {\n            this.lazada = res.data;\n        });\n        GetDataByShopAll().then(res => {\n            this.shop = res.data;\n        });\n\n        GetSaleByAll().then(res => {\n            this.salesman = res.data;\n        });\n    },\n    mounted() {\n        console.log(this.userinfo);\n    },\n    methods: {\n        handelToshop(row) {\n            this.postFrom.shop_id = row.id;\n            this.postFrom.shop_location = row.cityName + \" \" + row.location;\n            this.postFrom.shop_tel = row.tel;\n            this.innerVisible = !this.innerVisible;\n        },\n\n        handleSizeChange(val) {\n            this.shopQuery.limit = val;\n            this.getshopList();\n        },\n\n        handleStatusChange(val) {\n            this.shopQuery.page = 1;\n\n            this.getshopList();\n        },\n        handleCurrentChange(val) {\n            this.shopQuery.page = val;\n            this.getshopList();\n        },\n        getshopList() {\n            GetDataByList(this.shopQuery).then(response => {\n                this.shoplist = response.data.data;\n                this.shoptotal = response.data.total;\n            });\n        },\n        handelInn() {\n            this.shop = [];\n            this.innerVisible = !this.innerVisible;\n        },\n        handelCreate() {\n            const img = [];\n            for (let i = 0; i < this.imglist.length; i++) {\n                img.push(this.imglist[i].url);\n            }\n            const video = [];\n            for (let i = 0; i < this.videolist.length; i++) {\n                video.push(this.videolist[i].url);\n            }\n            this.postFrom.logcontent = this.userinfo.realName + \"创建订单\";\n            this.postFrom.imglist = img.join(\",\");\n            this.postFrom.videolsit = video.join(\",\");\n\n            if (this.postFrom.buy_product_id === undefined) {\n                this.$message.error(\"请选择产品\");\n                return;\n            } else {\n                if (this.postFrom.buy_product_id.constructor === Array) {\n                    this.postFrom.buy_product_id = this.postFrom.buy_product_id.join(\",\");\n                } else {\n                    this.postFrom.buy_product_id = this.postFrom.buy_product_id;\n                }\n            }\n\n            if (this.postFrom.lazada_list === undefined) {\n                this.$message.error(\"请选择平台\");\n                return;\n            } else {\n                if (this.postFrom.lazada_list.constructor === Array) {\n                    this.postFrom.lazada_list = this.postFrom.lazada_list.join(\",\");\n                } else {\n                    this.postFrom.lazada_list = this.postFrom.lazada_list;\n                }\n            }\n\n            if (this.postFrom.city_code === undefined) {\n                this.$message.error(\"请选择地址\");\n                return;\n            } else {\n                if (this.postFrom.city_code.constructor === Array) {\n                    this.postFrom.city_code = this.postFrom.city_code.join(\",\");\n\n                } else {\n                    this.postFrom.city_code = this.postFrom.city_code;\n                }\n\n            }\n            if (this.postFrom.car_model === undefined) {\n                this.$message.error(\"请选择车型\");\n                return;\n            } else {\n                if (this.postFrom.car_model.constructor === Array) {\n                    this.postFrom.car_model = this.postFrom.car_model.join(\",\");\n                } else {\n                    this.postFrom.car_model = this.postFrom.car_model;\n                }\n            }\n            PostDataByAdd(this.postFrom).then(res => {\n                this.$emit(\"handleClose\");\n                this.$message.success(\"操作成功\");\n            });\n        },\n\n        handelFile(e) {\n            this.imglist.push({url: e.file.data});\n        },\n        handelVideo(e) {\n            this.videolist.push({url: e.file.data});\n        },\n        loadData() {\n            this.loading = !this.loading;\n            GetIdBydetails(this.postFrom.order_id).then(res => {\n                if (res.data === 404) {\n                    this.$message.error(\"该订单不存在\");\n                    this.loading = !this.loading;\n                    return true;\n                }\n                this.is_load = true; // 如果使用订单载人那么用户不可修改数据\n                const postFrom = res.data;\n                if (postFrom.city_code.constructor === String) {\n                    postFrom.city_code = postFrom.city_code.split(\",\");\n                    for (let i = 0; i < postFrom.city_code.length; i++) {\n                        postFrom.city_code[i]=parseInt( postFrom.city_code[i]);\n                    }\n                }\n                if (postFrom.car_model.constructor === String) {\n                    postFrom.car_model = postFrom.car_model.split(\",\");\n                }\n\n                if (postFrom.buy_product_id.constructor === String) {\n                    postFrom.buy_product_id = postFrom.buy_product_id.split(\",\");\n                }\n                const buy_product_id = postFrom.buy_product_id;\n\n                postFrom.buy_product_id = [];\n                for (let i = 0; i < buy_product_id.length; i++) {\n                    postFrom.buy_product_id.push(parseInt(buy_product_id[i]));\n                }\n\n                if (postFrom.lazada_list.constructor === String) {\n                    postFrom.lazada_list = postFrom.lazada_list.split(\",\");\n                }\n                const lazada = postFrom.lazada_list;\n                postFrom.lazada_list = [];\n\n                for (let i = 0; i < lazada.length; i++) {\n                    postFrom.lazada_list.push(parseInt(lazada[i]));\n                }\n                this.postFrom = postFrom;\n                this.postFrom.order_id = postFrom.id;\n                this.loading = !this.loading;\n            });\n        },\n        // 所选门店\n        handleShop(e) {\n            this.postFrom.shop_id = e;\n            for (let i = 0; i < this.shop.length; i++) {\n                if (e === this.shop[i].id) {\n                    this.postFrom.shop_location =\n                        this.shop[i].cityName + \" \" + this.shop[i].location;\n                    this.postFrom.shop_tel = this.shop[i].tel;\n                    return;\n                }\n            }\n        },\n        handleClose() {\n            this.$emit(\"handleClose\");\n        },\n        updateRow(type) {\n            this.postFrom.logcontent = this.userinfo.realName + \"创建订单\";\n            // this.postFrom.city_code = this.postFrom.city_code.join(',')\n            // this.postFrom.car_model = this.postFrom.car_model.join(',')\n            // this.postFrom.lazada_list = this.postFrom.lazada_list.join(',')\n            // this.postFrom.buy_product_id = this.postFrom.buy_product_id.join(',')\n            //\n            // this.postFrom.logcontent =  this.userinfo.realName + '创建订单,'\n            // if(this.Stitle==='新增支付单'){\n            //   this.postFrom.status = 0\n            //   this.postFrom.pre_sales = this.userinfo.id\n            //   this.postFrom.logcontent =  this.userinfo.realName + '创建订单,'\n            // }\n            // console.log(  this.postFrom.logcontent,1)\n            //\n            // PostDataByAdd(this.postFrom).then(res => {\n            //   this.$emit('handleClose')\n            //\n            //   this.postFrom = Object.assign({}, defaultForm)\n            //   this.postFrom.city_code = this.postFrom.city_code.splice(',')\n            //   this.postFrom.car_model = this.postFrom.car_model.splice(',')\n            // })\n        }\n    }\n};\n",null]}