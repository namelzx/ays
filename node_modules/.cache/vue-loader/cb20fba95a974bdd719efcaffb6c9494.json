{"remainingRequest":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzexiang/WebstormProjects/ays/src/views/marketing/instalvide.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzexiang/WebstormProjects/ays/src/views/marketing/instalvide.vue","mtime":1587402564000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { GetDataBylist, PostDataByUpdate } from \"@/api/marketing\";\nimport { parseTime } from \"@/utils\";\nexport default {\n  name: \"instal\",\n  data() {\n    return {\n      listQuery: {\n        order_id: null,\n        page: 1,\n        limit: 10,\n        startTime: undefined,\n        sstatus: \"all\"\n      },\n      total: 0,\n      total1: 0,\n      total2: 0,\n      total3: 0,\n      listLoading: true,\n      tableData: [],\n      dialogVisible: false,\n      video: [],\n      is_video_status: undefined, //视频处理状态\n      order_id: undefined\n    };\n  },\n  filters: {\n    StrText(str) {\n      if (str === 1) {\n        return \"已处理\";\n      } else {\n        return \"待处理\";\n      }\n    }\n  },\n  created() {\n    this.fetchList();\n  },\n  methods: {\n    fetchList() {\n      this.listLoading = true;\n      GetDataBylist(this.listQuery).then(res => {\n        this.listLoading = false;\n        this.tableData = res.data.data.data;\n        this.total = res.data.data.total;\n        this.total1 = res.data.total1;\n        this.total2 = res.data.total2;\n        this.total3 = res.data.total3;\n\n        console.log(res, \"0909\");\n      });\n    },\n    handleFilter() {\n      this.listQuery.page = 1;\n      this.fetchList();\n    },\n    handleSizeChange(val) {\n      this.listQuery.limit = val;\n      this.fetchList();\n    },\n    handleCurrentChange(val) {\n      this.listQuery.page = val;\n      this.fetchList();\n    },\n    handleStatusChange(val) {\n      this.listQuery.page = 1;\n      this.listQuery.sstatus = val;\n      this.fetchList();\n    },\n    headSearch() {\n      this.listQuery.page = 1;\n      this.fetchList();\n    },\n    handleClose() {\n      this.dialogVisible = false;\n    },\n    handleEdit(index, row) {\n      this.dialogVisible = true;\n      this.video = row.video;\n\n      this.is_video_status = row.is_video_status;\n      console.log(row.is_video_status);\n      this.order_id = row.id;\n    },\n    open() {\n      this.$message({\n        message: \"请先选中视频！\",\n        type: \"warning\"\n      });\n    },\n    open2() {\n      this.$message({\n        message: \"恭喜你，已开始下载！\",\n        type: \"success\"\n      });\n    },\n    open4() {\n      this.$message.error(\"下载视频，请重新下载。\");\n    },\n    //下载视频\n    headDownload() {\n      let id = this.order_id;\n      let idslist = [];\n      let chenum = this.video.length;\n      let che = 0;\n      for (let i = 0; i < this.video.length; i++) {\n        if (this.video[i].status === true) {\n          che++;\n          idslist.push(this.video[i].id);\n        } else {\n          console.log(\"还没选择\");\n        }\n      }\n      let temp = {\n        ids: [],\n        id: \"\"\n      };\n      temp.ids = idslist.join(\",\");\n      temp.id = this.order_id;\n      if (chenum === che) {\n        PostDataByUpdate(temp).then(res => {\n          console.log(res);\n          if (res.code === 20000) {\n            for (let i = 0; i < this.video.length; i++) {\n              window.location.href = this.video[i].url;\n            }\n            this.dialogVisible = false;\n\n            this.open2();\n            this.fetchList();\n          } else {\n            this.open4();\n          }\n        });\n      } else {\n        this.open();\n      }\n    }\n  }\n};\n",null]}