{"remainingRequest":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzexiang/WebstormProjects/ays/src/views/user/userlist.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzexiang/WebstormProjects/ays/src/views/user/userlist.vue","mtime":1597725407657},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { change, changeAll, del, delAll, getList, PostDataByBlick, GetIdBydetele,GetDataBydownload } from '@/api/wechatuser'\nimport { Citylist } from '@/api/city'\nimport waves from '@/directive/waves'\n\nexport default {\n  directives: {\n    waves\n  },\n  data() {\n    return {\n      listQuery: {\n        page: 1,\n        limit: 10,\n        status: 'all',\n        title: '',\n        sstatus: 'all',\n        nickname: '',\n        contact: '',\n        cityCode: ''\n      },\n      optionsblick: [{\n        value: '1',\n        label: '拉黑'\n      }, {\n        value: '2',\n        label: '拉白'\n      }],\n      list: null,\n      total: 1,\n      checked: true,\n      listLoading: true,\n\n      cityoptions: [] // 地址\n    }\n  },\n  filters: {\n    blick(str) {\n      console.log(str)\n      if (str === 1) {\n        return '拉白'\n      } else {\n        return '拉黑'\n\n      }\n    }\n  },\n  created() {\n    // this.permissions = this.group.btn.split(\",\");\n    // Citylist().then(res => {\n    //   this.cityoptions = res.data;\n    // });\n    this.fetchList()\n  },\n  methods: {\n\n    handelblack(row) {\n      var str = '拉黑成功'\n      var temp = {\n        id: row.id,\n        is_black: 1\n      }\n\n      if (row.is_black === 1) {\n        temp.is_black = 2\n        str = '拉白成功'\n        row.is_black = 2\n      } else {\n        row.is_black = 1\n      }\n      PostDataByBlick(temp).then(res => {\n        this.$message.success(str)\n      })\n    },\n    handleUpdate( id) {\n      this.$router.push({ path: '/user/info/' + id })\n    },\n    fetchList() {\n      this.listLoading = true\n      console.log(this.listQuery.page)\n      getList(this.listQuery).then(response => {\n        this.list = response.data.data\n        this.total = response.data.total\n        this.listLoading = false\n        console.log(response.data.data, '111')\n      })\n    },\n    handleFilter() {\n      this.listQuery.page = 1\n      this.fetchList()\n    },\n    handleSizeChange(val) {\n      this.listQuery.page = val\n      this.fetchList()\n    },\n\n    handleCurrentChange(val) {\n      this.listQuery.page = val\n      this.listQuery.sstatus = val\n      this.fetchList()\n    },\n    handelDelete(index, id) {\n      GetIdBydetele(id).then(res => {\n        this.list.splice(index, 1)\n        this.$message.success('删除成功')\n\n      })\n    },\n    //导出数据\n    handleDownload() {\n      this.listLoading = true\n      GetDataBydownload(this.listQuery).then(res => {\n        import('@/vendor/Export2Excel').then(excel => {\n          console.log(excel)\n          const tHeader = res.data.tHeader\n          const filterVal = res.data.filterVal\n          const data = this.formatJson(res.data.data, filterVal)\n\n          var day2 = new Date()\n          day2.setTime(day2.getTime())\n          var s2 =\n            day2.getFullYear() +\n            '-' +\n            (day2.getMonth() + 1) +\n            '-' +\n            day2.getDate()\n          excel.export_json_to_excel({\n            header: tHeader,\n            data,\n            filename: '会员导出-' + s2\n          })\n          this.listLoading = false\n          this.$message.success('下载成功')\n        })\n      })\n    },\n    formatJson(data, filterVal) {\n      return data.map(v =>\n        filterVal.map(j => {\n          if (j === 'timestamp') {\n            return parseTime(v[j])\n          } else {\n            return v[j]\n          }\n        })\n      )\n    },\n  }\n}\n",null]}