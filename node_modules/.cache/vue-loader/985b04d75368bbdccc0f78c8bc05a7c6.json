{"remainingRequest":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liangzexiang/WebstormProjects/ays/src/views/order/install/OrderInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liangzexiang/WebstormProjects/ays/src/views/order/install/OrderInfo.vue","mtime":1594032547118},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liangzexiang/WebstormProjects/ays/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport DetailsInfo from './info/details'\nimport PayInfo from './info/pay'\n\n\n\nimport Timeline from './info/timeline'\nimport returnVisit from './info/returnVisit'\n\nimport { GetIdByOrderLog, GetTypeBySale, PostDataBySale, GetIdBypaydetails,GetIdBypayOrderLog } from '@/api/order'\n\nimport {GetInfoById } from '@/api/product'\n\nimport Upload from '@/components/Upload/eva'\n\nimport config from '@/config'\nimport { mapGetters } from 'vuex'\n\nexport default {\n  name: 'OrderInfo',\n\n  computed: {\n    ...mapGetters([\n      'userinfo',\n      'brand',\n      'group'\n    ])\n\n  },\n  components: {\n    DetailsInfo,\n    Timeline,\n    returnVisit,\n    Upload,\n    PayInfo\n  },\n  props: {\n    OrderInfo: {\n      type: Object,\n      default: function() {\n        return {}\n      }\n    },\n    tabtext:{\n      type:String,\n      default:'install',\n    },\n    infodialogVisible: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      distribution:{},\n      payinfo:[],\n      paylist:[],\n      payloglist:[],\n      is_payorder:false,\n      permissions: [],//权限组\n\n      reTitle: '',\n      sale: [],\n\n      returninnerVisible: false,\n      content: '',\n      img: [],\n      activeName: 'install',\n      loglist: [],\n      config: {\n        fileName: 'file',\n        limit: 5,\n        multiple: false,\n        accept: 'image/*',\n        action: config.uploadUrl.img,\n        drag: false\n      }\n    }\n  },\n  created() {\n    this.permissions = this.group.btn.split(',')\n    this.activeName=this.tabtext\n    let id=this.OrderInfo.product_id?this.OrderInfo.product_id:0\n    GetInfoById(id).then(res=>{\n      this.distribution=res.data\n    })\n\n  },\n  methods: {\n\n    rolesbtn(val) {\n      var index = this.permissions.indexOf(val)\n      if (index > -1) {\n        return true\n      } else {\n        return false\n      }\n    },\n    //添加售后数据\n    handelContent() {\n\n      var img='';\n      for (let i=0;i<this.img.length;i++){\n        img=img+this.img[i]['url']+'|'\n      }\n      var data = {\n        content: this.content,\n        img: img,\n        type: this.activeName,\n        order_id: this.OrderInfo.id\n      }\n      PostDataBySale(data).then(res => {\n        console.log(res)\n        this.getsale()\n        this.returninnerVisible = !this.returninnerVisible\n      })\n\n    },\n\n    getsale() {\n      var temp = {\n        order_id: this.OrderInfo.id,\n        type: this.activeName\n      }\n      GetTypeBySale(temp).then(res => {\n        // this.sale=res.data\n        var arr = []\n        for (let i = 0; i < res.data.length; i++) {\n          arr[i] = res.data[i]\n          arr[i].img = res.data[i].img.split('|')\n        }\n        this.sale = arr\n      })\n\n    },\n    //组件图片上传\n    handelRuimg(row) {\n      this.img.push({\n        url:row.data\n      })\n    },\n    handleClose() {\n      this.$emit('handelInfoDialog', !this.infodialogVisible)\n    },\n    handleClick(tab, event) {\n      //\n      if (tab.paneName === 'instalog') {\n        GetIdByOrderLog(this.OrderInfo.id).then(res => {\n          this.loglist = res.data\n        })\n      }\n      if (tab.paneName === 'paylog') {\n\n        GetIdBypayOrderLog(this.OrderInfo.id).then(res => {\n          this.payloglist = res.data\n        })\n      }\n\n\n      //如果是支付单\n      if (tab.paneName === 'pay') {\n        GetIdBypaydetails(this.OrderInfo.id).then(res => {\n          console.log(res)\n          if (res.data === 404) {\n            this.is_payorder = false\n            this.$message.error('尚未添加支付单')\n          }else{\n            let row=res.data\n            var paylist=res.data  ;\n\n            this.paylist=paylist\n            this.is_payorder=true;\n          }\n        })\n      }\n\n      if (tab.paneName === 'return') {\n        this.getsale()\n      }\n\n      if (tab.paneName === 'sales') {\n        this.getsale()\n      }\n    }\n  },\n  watch:{\n    'activeName':function (e) {\n\n\n      if (e=== 'return') {\n        this.getsale()\n      }\n      console.log('售后服务')\n\n      if (e === 'sales') {\n        this.getsale()\n      }\n    }\n  },\n}\n",null]}