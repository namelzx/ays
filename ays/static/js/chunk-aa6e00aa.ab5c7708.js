(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aa6e00aa"],{1361:function(e,t,a){"use strict";var i=a("b5d7"),n=a.n(i);n.a},"393f":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mb"},[a("el-dialog",{attrs:{title:"推广营销详情",visible:e.dialogVisible,width:"50%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"推广素材",name:"payinstall"}},[e._l(e.formdata.video,(function(t,i){return"视频"===e.formdata.type?a("div",{key:i,staticClass:"video"},[a("video",{staticStyle:{width:"200px",height:"100px"},attrs:{src:t.url,controls:"controls"}})]):e._e()})),e._v(" "),e._l(e.formdata.imagetext,(function(t,i){return"图文"==e.formdata.type?a("div",{key:i,staticClass:"video"},[a("el-image",{staticStyle:{width:"10rem",height:"5rem"},attrs:{src:t}})],1):e._e()}))],2),e._v(" "),a("el-tab-pane",{attrs:{label:"日志",name:"paylog"}},e._l(e.formdata.marketinglog,(function(t,i){return a("el-timeline-item",{key:i,attrs:{color:"#1d9ffc",timestamp:t.title}},[e._v("\n                      "+e._s(t.create_time)+"\n                  ")])})),1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.downloadZip}},[e._v("下载\n                  ")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("关闭")])],1)],1)],1)},n=[],r=(a("5df3"),a("2d63")),l=(a("ac6a"),a("b7be")),o=a("7c39"),s=a.n(o),m=a("21a6"),d=a.n(m),f={name:"form",data:function(){return{is_video_status:void 0,activeName:"payinstall",dialogVisible:!1,formdata:{}}},methods:{handleView:function(e){console.log(e),this.dialogVisible=!0,this.formdata=e},downloadZip:function(){var e=this;console.log(this.datafrom);var t=this.formdata.video,a=this.formdata.imagetext,i=[],n=this.formdata.type;if("视频"===n){if(0===t.length)return void this.$message.error("无数据下载");t.forEach((function(e){i.push({fileUrl:e.url,renameFileName:e.order_id+".mp4"})})),this.filesToRar(i,"案例打包")}if("图文"===n){i=[{fileUrl:a.passing_light_qt,renameFileName:"近光墙图.jpg"},{fileUrl:a.front,renameFileName:"车辆正面.jpg"},{fileUrl:a.distance_light_qt,renameFileName:"远光近墙图.jpg"},{fileUrl:a.product,renameFileName:"产品配置图.jpg"},{fileUrl:a.other_one,renameFileName:"其他1.jpg"},{fileUrl:a.assembly,renameFileName:"总成.jpg"},{fileUrl:a.vehiclebreaking,renameFileName:"拆车后.jpg"},{fileUrl:a.coating,renameFileName:"总成覆膜图.jpg"},{fileUrl:a.open_assembly,renameFileName:"开总成图.jpg"},{fileUrl:a.gelresin,renameFileName:"清胶图.jpg"},{fileUrl:a.lens,renameFileName:"透镜安装.jpg"},{fileUrl:a.situdimming,renameFileName:"原位调光图.jpg"},{fileUrl:a.inject_glue,renameFileName:"注胶过程图.jpg"},{fileUrl:a.truck_loading,renameFileName:"装车图.jpg"},{fileUrl:a.other_tow,renameFileName:"其他2.jpg"},{fileUrl:a.rear_passing_light_qt,renameFileName:"安装后近光墙.jpg"},{fileUrl:a.rear_front,renameFileName:"正面.jpg"},{fileUrl:a.rear_distance_light_qt,renameFileName:"远光后.jpg"},{fileUrl:a.rear_light_feature,renameFileName:"车灯特写.jpg"},{fileUrl:a.rear_passing_light_way,renameFileName:"近光照路.jpg"},{fileUrl:a.rear_distance_light_way,renameFileName:"远光照路.jpg"},{fileUrl:a.other_tow_three,renameFileName:"其他三.jpg"}],this.filesToRar(i,"案例打包"+new Date);var r={id:this.datafrom.id,filed:"status",status:1,title:"下载图文案例"};Object(l["f"])(r).then((function(t){if(console.log(t),2e4===t.code){for(var a=0;a<e.video.length;a++)window.location.href=e.video[a].url;e.dialogVisible=!1,e.open2()}else e.open4()}))}},filesToRar:function(e,t){var a=this,i=new s.a,n={},l=[];a.title="正在加载压缩文件";var o,m=Object(r["a"])(e);try{var f=function(){var e=o.value,t=a.getImgArrayBuffer(e.fileUrl).then((function(t){i.file(e.renameFileName,t,{binary:!0}),n[e.renameFileName]=t}));l.push(t)};for(m.s();!(o=m.n()).done;)f()}catch(c){m.e(c)}finally{m.f()}Promise.all(l).then((function(){i.generateAsync({type:"blob"}).then((function(e){a.title="正在压缩",d.a.saveAs(e,t),a.title="压缩完成"}))})).catch((function(e){a.$message.error("文件压缩失败")}))},getImgArrayBuffer:function(e){return new Promise((function(t,a){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(){200==this.status?t(this.response):a(this.status)},i.send()}))},handleClose:function(){this.dialogVisible=!1},handleClick:function(e,t){var a=this;"paylog"===e.paneName&&(this.loglist=[]),"instalog"===e.paneName&&(this.loglist=[],GetIdByinstaOrderLog(this.OrderInfo.order_id).then((function(e){a.loglist=e.data}))),"return"===e.paneName&&this.getsale(),console.log("售后服务"),"sales"===e.paneName&&this.getsale()},headDownload:function(){for(var e=this,t=(this.formdata.order_id,[]),a=this.formdata.video.length,i=0,n=0;n<this.formdata.video.length;n++)!0===this.formdata.video[n].status?(i++,t.push(this.formdata.video[n].id)):console.log("还没选择");var r={ids:[],id:""};r.ids=t.join(","),r.id=this.formdata.order_id,a===i?Object(l["PostDataByUpdate"])(r).then((function(t){if(console.log(t),2e4===t.code){for(var a=0;a<e.formdata.video.length;a++)window.location.href=e.formdata.video[a].url;e.dialogVisible=!1,e.$message({message:"恭喜你，已开始下载！",type:"success"})}else e.$message.error("下载视频，请重新下载。")})):this.$message.error("请选择下载的视频。")}}},c=f,u=(a("1361"),a("2877")),g=Object(u["a"])(c,i,n,!1,null,"1c3b83ca",null);t["default"]=g.exports},4:function(e,t){},5:function(e,t){},b5d7:function(e,t,a){},b7be:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"f",(function(){return r})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return o}));var i=a("b775");function n(e){return Object(i["a"])({url:"/admin/Marketing/GetDataByList",method:"get",params:e})}function r(e){return Object(i["a"])({url:"/admin/Marketing/PostStatusByData",method:"post",params:e})}function l(e){return Object(i["a"])({url:"/admin/Shopdemand/GetDataByShopDemanList",method:"get",params:e})}function o(e){return Object(i["a"])({url:"/admin/Shopdemand/PostDataByUpdate",method:"get",params:{id:e}})}}}]);